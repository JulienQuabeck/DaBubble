<app-middle-wrapper [hasDefaultPadding]="false" class="app-middle-wrapper">
  <div class="chat-content">
    <div class="current-nav-user">
      <img class="sender" src="assets/img/profiles/{{ fetchUser(toUserId)?.image_file }}" alt="" />
      <span>{{ fetchUser(toUserId)?.first_name }} {{ fetchUser(toUserId)?.last_name }}</span>
    </div>
    @if(chat){
    <div class="chat-container">
      <div *ngFor="let chatGroup of groupedChat">
        <div class="group-date">
          <span>{{ chatGroup.date }} </span>
          <div class="line"></div>
        </div>
        <div *ngFor="let message of chatGroup.messages" class="chat-message" [class.align-right]="message?.from_user !== authenticatedUser?.user_id">
          <div class="image-message">
            <img class="sender" src="assets/img/profiles/{{ fetchUser(message?.from_user)?.image_file }}" alt="" />
          </div>
          <div class="name-date-line">
            <div>
              <span>{{ fetchUser(message?.from_user)?.first_name }} {{ fetchUser(message?.from_user)?.last_name }}</span>
              <span>{{ setTimeFormat(message.send_date) }} Uhr</span>
            </div>
            <p>{{ message.message_content }}</p>
          </div>
        </div>
      </div>
    </div>
    } @else if(toUserId!='' || toUserId===authenticatedUser?.user_id) {
    <div id="message" class="message">
      <div>
        <div>
          <img class="sender" src="assets/img/profiles/{{ fetchUser(toUserId)?.image_file }}" alt="" />
          <span>{{ fetchUser(toUserId)?.first_name }} {{ fetchUser(toUserId)?.last_name }}</span>
        </div>
        <div>
          Diese Unterhaltung findet nur zwischen <span class="tag">&#64;{{ fetchUser(toUserId)?.first_name }} {{ fetchUser(toUserId)?.last_name }}</span>
          und dir statt.
        </div>
      </div>
    </div>
    }

    <div class="input-wrapper">
      <div class="input-form">
        <input
          class="message-input"
          [(ngModel)]="message_content"
          type="text"
          name="meassage"
          placeholder="Nachrichten an {{ fetchUser(toUserId)?.first_name }} {{ fetchUser(toUserId)?.last_name }}"
        />
        <div class="send-line">
          <div class="alternate-line">
            <img class="icons" src="assets/img/icons/input_add.svg" alt="" />
            <div class="sep-line"></div>
            <img class="icons" src="assets/img/icons/sentiment_satisfied.svg" alt="" />
            <img class="icons" src="assets/img/icons/alternate_email.svg" alt="" />
          </div>
          <button (click)="onAddMessage(authenticatedUser?.user_id, toUserId)">
            <img src="assets/img/icons/send.svg" alt="Send message" />
          </button>
        </div>
      </div>
    </div>
  </div>
</app-middle-wrapper>
